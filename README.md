# Congressional Financial Disclosure Analysis Tool

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)

An intelligent pattern-matching tool for analyzing publicly available Congressional financial disclosure documents using AI-powered optical character recognition.

---

## Legal disclaimer

**THIS SOFTWARE IS PROVIDED FOR INFORMATIONAL AND EDUCATIONAL PURPOSES ONLY.**

**THIS IS NOT INVESTMENT ADVICE, FINANCIAL ADVICE, LEGAL ADVICE, OR ANY FORM OF PROFESSIONAL ADVICE.**

The information generated by this software should **NOT** be used as the sole basis for any investment, financial, or legal decisions.

### Limitations and Liabilities

The developers, contributors, and distributors of this software:

- No warranties, express or implied, about the accuracy, completeness, or reliability of any analysis
- No liability for any losses, damages, or consequences arising from use of this software
- No guarantee of correctness of data extraction or any AI-generated analysis
- Not responsible for investment decisions made based on this tool's output

### User Responsibilities

Users must:

- Verify all information independently
- Consult qualified financial, legal, and tax professionals before making investment decisions
- Understand that past trading activity does not predict future performance
- Recognize that AI-generated analysis may contain errors or misinterpretations

**By using this software, you acknowledge and agree to these terms and accept full responsibility for your own decisions.**

---

## Overview

This tool employs advanced AI vision capabilities to automatically process House of Representatives financial disclosure PDF documents. It extracts structured information about stock transactions, asset holdings, and other financial data disclosed by members of Congress.

### Key Features

- AI-powered analysis: Uses vision-capable models for pattern recognition
- Batch processing: Analyzes multiple filings simultaneously for broader insights
- Automatic refresh: Downloads fresh XML metadata when stale
- Multi-threading: Parallel PDF fetching for performance
- Security: No hardcoded credentials—uses environment variables
- Rich output: Formatted tables and comprehensive analysis summaries

---

## Installation

### Prerequisites

- Python 3.8 or higher
- `poppler-utils` system package (for PDF processing)

### System Dependencies

**macOS:**
```bash
brew install poppler
```

**Ubuntu/Debian:**
```bash
sudo apt-get install poppler-utils
```

**Windows:**
Download from: https://github.com/oschwartz10612/poppler-windows/releases

### Python Packages

```bash
pip install -r requirements.txt
```

**Required packages:**
- `pandas` - Data manipulation
- `requests` - HTTP requests
- `colorlog` - Colored console output
- `fake-useragent` - User agent rotation
- `tabulate` - Table formatting
- `pdf2image` - PDF to image conversion

---

## Configuration

### OpenAI API Key

Set your OpenAI API key as an environment variable:

```bash
export OPENAI_API_KEY='your-api-key-here'
```

Get your API key from: https://platform.openai.com/api-keys

**For permanent configuration**, add to your shell profile:

```bash
# ~/.zshrc or ~/.bashrc
export OPENAI_API_KEY='your-api-key-here'
```

### Configuration Constants

Edit `load_xml.py` to customize behavior:

```python
DEFAULT_DAYS = 30          # Time window for filtering (days)
DEFAULT_TOP_N = None       # Number of results to display (None = all)
MAX_XML_AGE_DAYS = 2       # XML refresh threshold (days)
OPENAI_MODEL = "gpt-4.1-mini"  # AI model to use
```

---

## Usage

### Full Analysis Mode

Processes filings and performs AI analysis:

```bash
python3 load_xml.py
```

### Test Mode

Data processing only, without API calls:

```bash
python3 load_xml.py --test
```

---

## How It Works

### Workflow

1. **Download/Refresh XML**: Fetches latest metadata from House disclosure server
2. **Parse Records**: Loads and validates filing information
3. **Filter by Date**: Applies temporal filter (last N days)
4. **Build URLs**: Constructs PDF download links
5. **Fetch PDFs**: Downloads documents in parallel (20 threads)
6. **Convert to Images**: Renders PDF pages as PNG images
7. **AI Analysis**: Sends images to OpenAI Vision API for pattern recognition
8. **Display Results**: Shows formatted table and comprehensive summary

### Data Processing

```
House Disclosure Server
         ↓
   XML Metadata
         ↓
   Pandas DataFrame
         ↓
   Date Filtering
         ↓
   PDF URLs
         ↓
   Parallel Download (20 threads)
         ↓
   PDF → PNG Images
         ↓
   Base64 Encoding
         ↓
   OpenAI Vision API
         ↓
   Analysis Summary
```

---

## Output

### Example Output

```
================================================================================
Congressional Financial Disclosure Analysis Tool v1.0.0
================================================================================

[1/7] Loading XML metadata...
      Loaded 1,234 total disclosure records
[2/7] Processing filing dates...
      1,234 records with valid dates
[3/7] Filtering to last 30 days...
      15 recent filings match filter
...

================================================================================
FILING METADATA
================================================================================
   Last    First    DocID     FilingDate   Year
   Smith   John     12345678  2025-10-20   2025
   Doe     Jane     12345679  2025-10-19   2025
...

================================================================================
PDF URLS
================================================================================
1. https://disclosures-clerk.house.gov/.../2025/12345678.pdf
2. https://disclosures-clerk.house.gov/.../2025/12345679.pdf
...

================================================================================
COMPREHENSIVE STOCK ANALYSIS SUMMARY
================================================================================
[AI-generated analysis appears here]
================================================================================
```

---

## Performance Considerations

### API Costs

- Each PDF page consumes vision model tokens
- Batch processing limits: 3 pages/PDF, 20 total images
- Estimated cost: ~$0.01-0.05 per filing (varies by model pricing)

### Processing Time

- XML download: 5-10 seconds
- PDF fetching (parallel): 10-30 seconds for 10-20 filings
- AI analysis: 30-60 seconds depending on image count
- **Total**: ~1-2 minutes for typical batch

### Resource Usage

- RAM: ~500MB-1GB during processing
- Network: ~5-20MB download per filing
- Disk: Minimal (XML cache only)

---

## Data Source

**House of Representatives Financial Disclosures**  
https://disclosures-clerk.house.gov/

All data processed by this tool is publicly available information filed under the Ethics in Government Act and House Rules.

---

## Troubleshooting

### "No XML file found"

The tool automatically downloads the XML. If this fails:
1. Check internet connection
2. Verify you can access https://disclosures-clerk.house.gov/
3. Try running in test mode first: `python3 load_xml.py --test`

### "pdf2image not available"

Install system dependencies:
```bash
# macOS
brew install poppler

# Ubuntu/Debian  
sudo apt-get install poppler-utils
```

Then reinstall Python package:
```bash
pip install --upgrade pdf2image
```

### "OpenAI API error"

Common issues:
- **Invalid API key**: Verify key is correct and active
- **Rate limit**: Wait and retry, or reduce batch size
- **Timeout**: Increase timeout in code or process fewer images
- **Quota exceeded**: Check OpenAI billing dashboard

### "No filings found"

Increase the look-back period:
```python
DEFAULT_DAYS = 60  # Increase from 30 to 60 days
```

---

## Development

### Project Structure

```
2025FD/
├── load_xml.py           # Main application
├── 2025FD.xml           # Cached XML metadata (auto-generated)
├── requirements.txt     # Python dependencies
└── README.md           # This file
```

### Code Quality

- **Type hints**: Function signatures use type annotations
- **Docstrings**: Comprehensive documentation for all functions
- **Error handling**: Specific exception handling with informative messages
- **Logging**: Color-coded console output for easy debugging
- **Security**: No hardcoded credentials, environment-based configuration

### Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes with proper documentation
4. Test thoroughly (including `--test` mode)
5. Submit a pull request

---

## License

MIT License - See LICENSE file for details

---

## Acknowledgments

- **Data Source**: U.S. House of Representatives Office of the Clerk
- **AI Model**: OpenAI GPT-4 Vision
- **PDF Processing**: pdf2image library
- **Community**: Open source contributors

---

## Disclaimer (Repeated for Emphasis)

**THIS TOOL IS FOR INFORMATIONAL PURPOSES ONLY. IT IS NOT INVESTMENT ADVICE.**

Always conduct your own research and consult qualified professionals before making financial decisions. The creators of this tool assume no responsibility for how you use this information.

---

## Support

For issues, questions, or suggestions:
1. Check this README for troubleshooting
2. Review code comments and docstrings
3. Open an issue on the repository

---

**Version**: 1.0.0  
**Last Updated**: October 2025  
**Python**: 3.8+  
**License**: MIT
